<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Circuito Alternativo de Tênis</title>
		<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
		<link rel="stylesheet" href="css/bootstrap.css">
		<script src="js/jquery-1.11.2.js"></script>
		<script src="js/angular.js"></script>
		<script src="js/bootstrap.js"></script>
		<script src="js/angular-resource.min.js"></script>
		<script src="js/angular-route.min.js"></script>
		<script src="pageController.js"></script>
		<script src="rankingController.js"></script>
		<script src="tournamentController.js"></script>
		<link rel="stylesheet" href="css/style.css">
</head>

	<body ng-app="RankingApp" ng-controller="RankingController">

			<div ng-view>

			</div>

			<ul class="nav nav-tabs" style="margin-bottom:10px;" ng-controller="PageController">
				<li id="tab_tournaments" role="presentation" class="active"><a ng-click="showTab(2)">Torneios</a></li>
				<li id="tab_ranking" role="presentation"><a ng-click="showTab(1)">Ranking Geral</a></li>
				<!-- <li id="tab_blog" role="presentation" class="pull-right"><a href="http://www.catenis.com.br/blog">CATenis.com.br</a> -->
				<li id="tab_login" ng-show="(session.data)" role="presentation" class="pull-right">
					<a ng-click="logout()" href="#">{{session.data.login}} (Logout)</a></li>
				<li id="tab_login" ng-hide="(session.data)" role="presentation" class="pull-right"><a href="/#/login">Login</a></li>
			</ul>

			<div id="div_tournaments" ng-controller="TournamentController">

			 	<div class="panel panel-default">

					<div class="panel-heading">
						<img src="img/trophy.png" style="width: 55px;height:55px;float:left;margin-right:10px">
						<h3>Torneios</h3>
					</div>
					<div class="panel-body">

						<table class="table table-striped">

							<tr class="h4">
								<th>Torneio</th>
								<th align="center" width="10%"></th>
							</tr>
							
							<tr id="loadingtournaments" ng-hide="listLoaded">
								<td colspan="4" align="center">
									<img src="img/ajax-loader.gif">
								</td>
							</tr>

							<tr ng-repeat="tourn in tournList | orderBy:'-_id'" ng-init="checkRunning(tourn)" ng-click="filterTournamentMatches(tourn._id)">
								<td>
									<a href="">{{tourn.name}}</a>
								</td>
								<td align="right">
									<a ng-show="(session.data)" ng-href="/#/matches/{{tourn._id}}" class="btn btn-primary btn-xs">
										Adicionar partida
									</a>
								</td>
							</tr>

						</table>

					</div>
					
				</div>

				<div class="panel panel-default">
					
					<div id="tournmatches" class="panel-heading">
						<img src="img/picture.jpg" style="width: 55px;height:55px;float:left;margin-right:10px">
						<h3>{{selectedTournament.name}}</h3>
					</div>
					<div class="panel-body">

						<table class="table table-striped">

							<tr ng-show="(selectedTournament.groups.length > 0)">
								<td colspan="3" align="center">
									<span class="label label-info">{{selectedTournament.groups[0].groupname}}</span>
									<span class="label label-success">{{selectedTournament.groups[1].groupname}}</span>
								</td>
							</tr>

							<tr ng-repeat="player in tournamentPlayerList | orderBy:['group','-tournamentpoints','name']"
							ng-class="(selectedTournament.groups.length > 0) ? ((player.group == selectedTournament.groups[0].groupname) ? 'info' : 'success' ): ''">
								<td align="center" width="5%"><strong>{{($index+1>5 && selectedTournament.groups.length > 0) ? $index+1-5 : $index+1}}</strong></td>
								<td>
									{{player.name}}
								</td>
								<!-- <td align="center">{{getMatchCount(player._id)}}</td> -->
								<td width="10%" align="center">{{player.tournamentpoints}}</td>
							</tr>

						</table>
						
						<table class="table table-condensed" ng-show="(selectedTournament.brackets.type == 'Q')">

							<tr bgcolor="#EEE">
								<th>Quartas</th>
								<th>Semis</th>
								<th>Final</th>
							</tr>
							<tr>
								<td>
									<input type="text" id="q1" value="{{selectedTournament.brackets.q1}}" style="width:80px" disabled><br>
									<input type="text" id="q2" value="{{selectedTournament.brackets.q2}}" style="width:80px" disabled>
								</td>
								<td style="vertical-align:middle" rowspan="2">
									<input type="text" id="s1" value="{{selectedTournament.brackets.s1}}" style="width:80px" disabled><br>
									<input type="text" id="s2" value="{{selectedTournament.brackets.s2}}" style="width:80px" disabled>
								</td>
								<td style="vertical-align:middle" rowspan="4">
									<input type="text" id="f1" value="{{selectedTournament.brackets.f1}}" style="width:80px" disabled><br>
									<input type="text" id="f2" value="{{selectedTournament.brackets.f2}}" style="width:80px" disabled>
								</td>
							</tr>
							<tr>
								<td>
									<input type="text" id="q3" value="{{selectedTournament.brackets.q3}}" style="width:80px" disabled><br>
									<input type="text" id="q4" value="{{selectedTournament.brackets.q4}}" style="width:80px" disabled>
								</td>
							</tr>
							<tr>
								<td>
									<input type="text" id="q5" value="{{selectedTournament.brackets.q5}}" style="width:80px" disabled><br>
									<input type="text" id="q6" value="{{selectedTournament.brackets.q6}}" style="width:80px" disabled>
								</td>
								<td style="vertical-align:middle" rowspan="2">
									<input type="text" id="s3" value="{{selectedTournament.brackets.s3}}" style="width:80px" disabled><br>
									<input type="text" id="s4" value="{{selectedTournament.brackets.s4}}" style="width:80px" disabled>
								</td>
							</tr>
							<tr>
								<td>
									<input type="text" id="q7" value="{{selectedTournament.brackets.q7}}" style="width:80px" disabled><br>
									<input type="text" id="q8" value="{{selectedTournament.brackets.q8}}" style="width:80px" disabled>
								</td>
							</tr>


						</table>

						<table class="table table-condensed" ng-show="(selectedTournament.brackets.type == 'S')">

							<tr bgcolor="#EEE">
								<th>Semis</th>
								<th>Final</th>
							</tr>
							<tr>
								<td style="vertical-align:middle">
									<input type="text" id="s1" value="{{selectedTournament.brackets.s1}}" style="width:80px" disabled><br>
									<input type="text" id="s2" value="{{selectedTournament.brackets.s2}}" style="width:80px" disabled>
								</td>
								<td style="vertical-align:middle" rowspan="2">
									<input type="text" id="f1" value="{{selectedTournament.brackets.f1}}" style="width:80px" disabled><br>
									<input type="text" id="f2" value="{{selectedTournament.brackets.f2}}" style="width:80px" disabled>
								</td>
							</tr>
							<tr>
								<td style="vertical-align:middle">
									<input type="text" id="s3" value="{{selectedTournament.brackets.s3}}" style="width:80px" disabled><br>
									<input type="text" id="s4" value="{{selectedTournament.brackets.s4}}" style="width:80px" disabled>
								</td>
							</tr>


						</table>

						<table class="table table-condensed" style="margin-bottom:5px" 
							ng-repeat="match in tournamentMatchList | orderBy:['-tourn_id','_id']"
							ng-class="(match.score.set_p1==0 && match.score.set_p2==0) ? 'list-group-item-custom' : 'list-group-item-warning'">

							<tr>
								<td width="5%" rowspan="2" style="text-align:center;vertical-align:middle">
									{{match.round}}
								</td>
								<td width="50%" style="vertical-align:middle" ng-class="(fullMatch.player1 == selectedPlayer.id) ? 'player-selected' : ''">
									<span ng-class="(match.score.set_p1==0 && match.score.set_p2==0) ? 'label-default' : 'label-warning'" class="label">
										{{ (match.score.wo) ? ((match.score.set_p1!=0) ? "w" : "O") : match.score.set_p1 }}</span>
									{{getPlayerName(match.p1_id)}}
								</td>
								
								<td width="25%" align="right" style="vertical-align:middle">
									<span ng-repeat="game in match.score.games" class="label label-default" style="margin-right:5px">{{game.game_p1}}</span>
								</td>
							</tr>
							<tr>
								<td style="vertical-align:middle" ng-class="(fullMatch.player2 == selectedPlayer.id) ? 'player-selected' : ''">
									<span ng-class="(match.score.set_p1==0 && match.score.set_p2==0) ? 'label-default' : 'label-warning'" class="label">
										{{ (match.score.wo) ? ((match.score.set_p2!=0) ? "w" : "O") : match.score.set_p2 }}</span>
									{{getPlayerName(match.p2_id)}}
								</td>
								<td align="right" style="vertical-align:middle">
									<span ng-repeat="game in match.score.games" class="label label-default" style="margin-right:5px">{{game.game_p2}}</span>
								</td>
							</tr>
							<tr ng-show="(session.data)">
								<td colspan="3" style="text-align:right;vertical-align:middle;padding:0px;margin:0px;">

									<span ng-show="(session.data && match.score.set_p1==0 && match.score.set_p2==0)">
										<a ng-click="setSelectedMatch(match)" ng-href="/#/matches/{{selectedTournament._id}}/{{match._id}}" class="btn btn-primary btn-xs">
											Inserir Placar
										</a>
									</span>
									<span ng-show="(session.data)">
										<a ng-click="removeMatch(match)" confirmation-needed="Deseja realmente excluir?" class="btn btn-danger btn-xs">
											Remover Partida
										</a>
									</span>

								</td>
							</tr>
							
						</table>
					</div>

				</div> 

			</div> <!-- END OF TOURNAMENTS -->

			<div id="div_ranking" style="display:none;">

				<div class="panel panel-default">

					<div class="panel-heading">
						<img src="img/icon.png" style="width: 55px;height:55px;float:left;margin-right:10px">
						<h3>Ranking Geral</h3>
					</div>
					<div class="panel-body">

						<table class="table table-striped">

							<tr class="h4">
								<th width="5%"> </th>
								<th>
									Jogador
									<a ng-href="/#/players" ng-show="(session.data)" class="btn btn-primary btn-xs">Adicionar</a>
								</th>
								<!-- <td align="center" width="10%">Jogos</td> -->
								<th style="text-align:center" align="center" width="10%">Pontos</th>
							</tr>
							
							<tr id="loadingplayers" ng-hide="listLoaded">
								<td colspan="4" align="center">
									<img src="img/ajax-loader.gif">
								</td>
							</tr>

							<tr ng-repeat="player in playerList | orderBy:['-points','name']" ng-click="filterPlayerMatches(player._id)">
								<td align="center"><strong>{{$index+1}}</strong></td>
								<td>
									<a href="">{{player.name}}</a>
								</td>
								<!-- <td align="center">{{getMatchCount(player._id)}}</td> -->
								<td align="center">{{player.points}}</td>
							</tr>

							<tr>
								<td colspan="3" align="center" style="font-size: 10px">
									<strong>Pontuação</strong><br/>
									<strong>RR:</strong> 10 (Vencedor) / 5 (Perdedor) -
									<strong>Q:</strong> 20 -
									<strong>S:</strong> 20 -
									<strong>F:</strong> 50 (Campeão) / 20 (Vice)
								</td>
							</tr>

						</table>

					</div>
					
				</div>

				<div class="panel panel-default">
					
					<div id="matches" class="panel-heading">
						<img src="img/picture.jpg" style="width: 55px;height:55px;float:left;margin-right:10px">
						<h3>{{selectedPlayer.name}}</h3>
					</div>
					<div class="panel-body">
						
						<table class="table table-condensed" style="margin-bottom:5px" 
							ng-repeat="match in playerMatchList | orderBy:['-tourn_id','_id']" 
							ng-init="checkTournament(match)"
							ng-class="(match.victory) ? 'list-group-item-success' : (match.score.set_p1==match.score.set_p2) ? 'list-group-item-custom' : 'list-group-item-danger'">

							<tr ng-hide="match.sameTournament">
								<td colspan="4" style="background:#FFF;color:#000">
									 <strong>Torneio:</strong> {{getTournamentName(match.tourn_id)}}
								</td>
							<tr>
							<tr>
								<td width="10%" rowspan="2" style="text-align:center;vertical-align:middle">
									{{match.round}}
								</td>
								<td width="70%" style="vertical-align:middle" ng-class="(fullMatch.player1 == selectedPlayer.id) ? 'player-selected' : ''">
									<span ng-class="(match.victory) ? 'label-success' : (match.score.set_p1==match.score.set_p2) ? 'label-default' : 'label-danger'" 
									class="label">{{ (match.score.wo) ? ((match.score.set_p1!=0) ? "w" : "O") : match.score.set_p1 }}</span>
									{{getPlayerName(match.p1_id)}}
								</td>
								<td width="20%" align="right" style="vertical-align:middle">
									<span ng-repeat="game in match.score.games" class="label label-default" style="margin-right:5px">{{game.game_p1}}</span>
								</td>
							</tr>
							<tr>
								<td style="vertical-align:middle" ng-class="(fullMatch.player2 == selectedPlayer.id) ? 'player-selected' : ''">
									<span ng-class="(match.victory) ? 'label-success' : (match.score.set_p1==match.score.set_p2) ? 'label-default' : 'label-danger'" 
									class="label">{{ (match.score.wo) ? ((match.score.set_p2!=0) ? "w" : "O") : match.score.set_p2 }}</span>
									{{getPlayerName(match.p2_id)}}
								</td>
								<td align="right" style="vertical-align:middle">
									<span ng-repeat="game in match.score.games" class="label label-default" style="margin-right:5px">{{game.game_p2}}</span>
								</td>
							</tr>
							
						</table>
					</div>

				</div> 

			</div>	<!-- END OF RANKING -->

	</body>
</html>
